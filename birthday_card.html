<!-- birthday_card.html - æ¢¦å¹»è“ç´«ç‰ˆï¼ˆæ°”çƒ+è›‹ç³•+è‡ªåŠ¨æ’­æ”¾éŸ³ä¹ï¼‰ -->
<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>æ¢¦å¹»ç”Ÿæ—¥ç¥ç¦å¡ ğŸ’œğŸ‚</title>
  <style>
    html,body{height:100%;margin:0;overflow-x:hidden;font-family:'Segoe UI',sans-serif;color:#fff}
    body{
      background:linear-gradient(180deg,#2e026d 0%,#6b21a8 40%,#7e22ce 100%);
      background-attachment:fixed;
      position:relative;
    }

    /* æ¼‚æµ®æ°”çƒåŠ¨ç”» */
    .balloon{
      position:absolute;
      bottom:-150px;
      width:60px;height:80px;
      border-radius:50%;
      background:radial-gradient(circle at 30% 30%,rgba(255,255,255,0.9),rgba(180,150,255,0.8));
      box-shadow:inset -4px -6px 10px rgba(0,0,0,0.2);
      animation:float 12s ease-in-out infinite;
    }
    @keyframes float {
      0%{transform:translateY(0) rotate(0deg);opacity:1}
      50%{transform:translateY(-800px) rotate(6deg);opacity:0.9}
      100%{transform:translateY(-1600px) rotate(-6deg);opacity:0}
    }

    /* å¤šä¸ªæ°”çƒä¸åŒä½ç½®å’Œå»¶è¿Ÿ */
    .b1{left:10%;animation-delay:0s;background-color:#f9a8d4}
    .b2{left:30%;animation-delay:3s;background-color:#93c5fd}
    .b3{left:50%;animation-delay:6s;background-color:#c4b5fd}
    .b4{left:70%;animation-delay:1.5s;background-color:#fcd34d}
    .b5{left:85%;animation-delay:4.5s;background-color:#a7f3d0}

    header{text-align:center;padding:24px 12px;animation:fadein 2s ease forwards;}
    @keyframes fadein{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:none}}
    h1{font-size:26px;margin:0;color:#f3e8ff;text-shadow:0 0 10px #a855f7}
    p.small{font-size:13px;color:#ddd}

    .container{max-width:1000px;margin:0 auto;z-index:2;position:relative;padding:12px}
    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    @media(min-width:800px){.grid{grid-template-columns:1fr 1fr}}

    .card{background:rgba(255,255,255,0.1);backdrop-filter:blur(8px);padding:16px;border-radius:16px;box-shadow:0 0 20px rgba(255,255,255,0.2)}
    label{display:block;font-size:14px;margin-top:8px;color:#eee}
    input[type=text],textarea,select{width:100%;padding:10px;border-radius:10px;border:none;margin-top:4px;font-size:14px}
    textarea{resize:vertical}
    .btn{display:inline-block;padding:8px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:600}
    .btn.primary{background:#9333ea;color:#fff}
    .btn.ghost{background:transparent;border:1px solid #e9d5ff;color:#e9d5ff}

    .preview-wrap{padding:12px;text-align:center}
    .card-preview{max-width:540px;margin:0 auto;padding:28px;border-radius:16px;box-shadow:0 0 30px rgba(255,255,255,0.2)}
    .classic{background:linear-gradient(135deg,#d8b4fe,#c084fc);color:#fff}
    .minimal{background:rgba(255,255,255,0.2);color:#fff}
    .retro{background:linear-gradient(135deg,#312e81,#7e22ce);color:#fff}

    .name{font-size:28px;font-weight:700;margin-bottom:8px}
    .msg{font-size:16px}

    /* è›‹ç³•SVG */
    .cake{margin-top:20px;display:inline-block;animation:fadein 3s ease forwards}
    .flame{animation:flicker 1s infinite alternate}
    @keyframes flicker{from{opacity:0.6;transform:scale(1)}to{opacity:1;transform:scale(1.1)}}

    footer{text-align:center;color:#ddd;font-size:12px;margin-top:24px}

  </style>
</head>
<body>
  <!-- æ¼‚æµ®æ°”çƒ -->
  <div class="balloon b1"></div>
  <div class="balloon b2"></div>
  <div class="balloon b3"></div>
  <div class="balloon b4"></div>
  <div class="balloon b5"></div>

  <div class="container">
    <header>
      <h1>ğŸ‰ æ¢¦å¹»è“ç´«ç”Ÿæ—¥ç¥ç¦å¡ ğŸ’œ</h1>
      <p class="small">ç”Ÿæˆé“¾æ¥å¹¶åˆ†äº«ç»™å¥½å‹ï¼Œä¸€èµ·åº†ç¥ç”Ÿæ—¥ï¼</p >
    </header>

    <main class="grid">
      <section class="card">
        <label>æ”¶ä»¶äººåå­—</label>
        <input id="inputName" type="text" placeholder="ä¾‹å¦‚ï¼šå°ç¾">

        <label>ç¥ç¦è¯­</label>
        <textarea id="inputMsg" rows="5" placeholder="å†™ä¸‹ä½ çš„ç”Ÿæ—¥ç¥ç¦..."></textarea>

        <label>æ¨¡æ¿</label>
        <select id="inputTpl">
          <option value="classic">æ¢¦å¹»ç´«ï¼ˆé»˜è®¤ï¼‰</option>
          <option value="minimal">æç®€é€æ˜</option>
          <option value="retro">å¤œè‰²å¤å¤</option>
        </select>

        <div style="margin-top:12px">
          <button id="btnPreview" class="btn primary">é¢„è§ˆå¹¶ç”Ÿæˆé“¾æ¥</button>
          <button id="btnReset" class="btn ghost">é‡ç½®</button>
        </div>
      </section>

      <section class="card">
        <div class="preview-wrap">
          <div id="previewBox" class="card-preview classic">
            <div class="name" id="pvName">ä½ çš„åå­—</div>
            <div class="msg" id="pvMsg">åœ¨è¿™é‡Œå†™ä¸‹ç¥ç¦ï¼Œä¼šå®æ—¶æ˜¾ç¤º...</div>
            <!-- è›‹ç³•å›¾æ¡ˆ -->
            <div class="cake">
              <svg width="120" height="120" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
                <rect x="25" y="60" width="70" height="30" rx="8" fill="#f9a8d4" stroke="#fff" stroke-width="2"/>
                <rect x="35" y="45" width="50" height="15" rx="4" fill="#fde68a" stroke="#fff" stroke-width="2"/>
                <rect x="55" y="30" width="10" height="15" fill="#f87171"/>
                <circle class="flame" cx="60" cy="25" r="4" fill="#facc15"/>
              </svg>
            </div>
          </div>
        </div>

        <div style="margin-top:14px">
          <input id="shareLink" readonly value="" style="width:100%;padding:8px;border-radius:8px;border:none">
          <div style="display:flex;gap:8px;justify-content:center;margin-top:8px">
            <button id="btnCopy" class="btn primary">å¤åˆ¶é“¾æ¥</button>
            <button id="btnShare" class="btn ghost">åŸç”Ÿåˆ†äº«</button>
          </div>
          <div id="copyNote" style="color:#a7f3d0;margin-top:8px;display:none;text-align:center">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ âœ…</div>
        </div>
      </section>
    </main>

    <audio id="bgm" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_4c3ff9c6d7.mp3?filename=happy-birthday-118.mp3" loop preload="auto"></audio>
    <footer>ğŸ‚ ä¿å­˜ä¸º <strong>birthday_card.html</strong> å¹¶ç”¨æµè§ˆå™¨æ‰“å¼€å³å¯ä½¿ç”¨ã€‚éŸ³ä¹è‡ªåŠ¨æ’­æ”¾ã€‚</footer>
  </div>

  <script>
    function qs(id){return document.getElementById(id)}
    const inputName=qs('inputName'),inputMsg=qs('inputMsg'),inputTpl=qs('inputTpl')
    const pvName=qs('pvName'),pvMsg=qs('pvMsg'),previewBox=qs('previewBox')
    const shareLink=qs('shareLink'),btnPreview=qs('btnPreview'),btnReset=qs('btnReset')
    const btnCopy=qs('btnCopy'),btnShare=qs('btnShare'),copyNote=qs('copyNote')
    const bgm=qs('bgm')

    const params=new URLSearchParams(location.search)
    const sharedName=params.get('name')||''
    const sharedMsg=params.get('msg')||''
    const sharedTpl=params.get('tpl')||'classic'

    function applyShared(){
      if(sharedName||sharedMsg){
        pvName.textContent=sharedName||'æœ‹å‹'
        pvMsg.textContent=sharedMsg||''
        previewBox.className='card-preview '+(sharedTpl||'classic')
        bgm.play().catch(()=>{})
      }
    }
    applyShared()

    inputName.addEventListener('input',()=>{pvName.textContent=inputName.value||'ä½ çš„åå­—';updateLink()})
    inputMsg.addEventListener('input',()=>{pvMsg.textContent=inputMsg.value||'åœ¨è¿™é‡Œå†™ä¸‹ç¥ç¦ï¼Œä¼šå®æ—¶æ˜¾ç¤º...';updateLink()})
    inputTpl.addEventListener('change',()=>{previewBox.className='card-preview '+inputTpl.value;updateLink()})

    function buildShareURL(){
      const base=location.origin+location.pathname
      const u=new URL(base)
      if(inputName.value)u.searchParams.set('name',inputName.value)
      if(inputMsg.value)u.searchParams.set('msg',inputMsg.value)
      if(inputTpl.value)u.searchParams.set('tpl',inputTpl.value)
      return u.toString()
    }
    function updateLink(){shareLink.value=buildShareURL()}

    btnPreview.addEventListener('click',()=>{updateLink();bgm.currentTime=0;bgm.play().catch(()=>{})})
    btnReset.addEventListener('click',()=>{inputName.value='';inputMsg.value='';inputTpl.value='classic';pvName.textContent='ä½ çš„åå­—';pvMsg.textContent='åœ¨è¿™é‡Œå†™ä¸‹ç¥ç¦ï¼Œä¼šå®æ—¶æ˜¾ç¤º...';previewBox.className='card-preview classic';shareLink.value='';copyNote.style.display='none';bgm.pause();bgm.currentTime=0})

    btnCopy.addEventListener('click',async()=>{
      const link=buildShareURL()
      try{await navigator.clipboard.writeText(link);copyNote.style.display='block';setTimeout(()=>copyNote.style.display='none',1800)}catch(e){const ta=document.createElement('textarea');ta.value=link;document.body.appendChild(ta);ta.select();document.execCommand('copy');ta.remove();copyNote.style.display='block';setTimeout(()=>copyNote.style.display='none',1800)}
    })

    btnShare.addEventListener('click',()=>{
      const url=buildShareURL()
      if(navigator.share){navigator.share({title:'ç”Ÿæ—¥ç¥ç¦',text:inputMsg.value||'ç”Ÿæ—¥å¿«ä¹',url}).catch(()=>{})}else{btnCopy.click()}
    })

    function fillInputs(){
      if(sharedName)inputName.value=sharedName
      if(sharedMsg)inputMsg.value=sharedMsg
      if(sharedTpl)inputTpl.value=sharedTpl
      pvName.textContent=inputName.value||pvName.textContent
      pvMsg.textContent=inputMsg.value||pvMsg.textContent
      previewBox.className='card-preview '+(inputTpl.value||'classic')
      updateLink()
    }
    fillInputs()
  </script>
</body>
</html>